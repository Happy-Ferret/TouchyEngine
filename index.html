<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><title>title</title><link rel="stylesheet" href="style.css">
<script type="text/javascript">
function onloadf() {
    function componentToHex(c) {
        var hex = c.toString(16);
        return hex.length == 1 ? "0" + hex : hex;
    }

    function rgbToHex(rgba) {
        return "#" + componentToHex(rgba[0]) + componentToHex(rgba[1]) + componentToHex(rgba[2]);
    }

    var ctx = document.getElementById('maincanvas').getContext('2d');
    var ctxm = document.getElementById('maskcanvas').getContext('2d');
    var maskdata = []
   
    //Loading of the home test image - img1
    var img1 = new Image();
    //drawing of the test image - img1
    img1.onload = function () {
        //draw background image
        ctx.drawImage(img1, 0, 0);
    };
    img1.src = 'nasa.png';

    //Loading of the home test image - img1
    var img2 = new Image();
    //drawing of the test image - img1
    img2.onload = function () {
        //draw background image
        ctxm.drawImage(img2, 0, 0);
        maskdata = ctxm.getImageData(0, 0, canvas.width, canvas.height);
    };
    img2.src = 'nasamask8.png';

    function writeMessage(canvas, message, bgcolor) {
        var context = canvas.getContext('2d');
        context.fillStyle = bgcolor;
        context.fillRect(0, 0, 500, 30);
        context.font = '18pt Calibri';
        context.fillStyle = 'black';
        context.fillText(message, 10, 25);
    }

    function getMousePos(canvas, evt) {
        var rect = canvas.getBoundingClientRect();
        return {
            x: evt.clientX - rect.left,
            y: evt.clientY - rect.top
        };
    }

    function getpixel(x,y){
        var imgW = maskdata.width
        
        var red = maskdata.data[((imgW * y) + x) * 4];
        var green = maskdata.data[((imgW * y) + x) * 4 + 1];
        var blue = maskdata.data[((imgW * y) + x) * 4 + 2];
        var alpha = maskdata.data[((imgW * y) + x) * 4 + 3];

        return [red,green,blue]
    }

    function writecxymessage(canvas, x,y){
        var pixel = getpixel(x, y);
        var message = 'position: ' + x + ',' + y  ;
        writeMessage(canvas, message, rgbToHex(pixel));
    }

    var canvas = document.getElementById('maincanvas')
    var scale = 1;
    var mscale = 1;

    function resizecanvases(){
        var canvas = document.getElementById('maincanvas')
        var maskcanvas = document.getElementById('maskcanvas')

        if(window.innerHeight > window.innerWidth){
            scale = window.innerWidth/canvas.width
            mscale = window.innerWidth/maskcanvas.width            
        } else { 
            scale = window.innerHeight/canvas.height
            mscale = window.innerHeight/maskcanvas.height
        }

        canvas.style.height = scale*canvas.height + 'px';
        canvas.style.width = scale*canvas.width + 'px';
        maskcanvas.style.height = mscale*maskcanvas.height + 'px';
        maskcanvas.style.width = mscale*maskcanvas.width + 'px';


    }
   
    resizecanvases()

    canvas.addEventListener('mousemove', function(evt) {
        var canvas = document.getElementById('maincanvas');
        var mousePos = getMousePos(canvas, evt);
        writecxymessage(canvas, Math.floor(mousePos.x/mscale), Math.floor(mousePos.y/mscale));
    }, false);

    canvas.addEventListener('ontouchstart', function(evt) {
        var canvas = document.getElementById('maincanvas');
        var offsetLeft = canvas.offsetLeft;
        var offsetTop = canvas.offsetTop;
        var x=Math.floor((evt.touches[0].pageX-offsetLeft)/mscale);
		var y=Math.floor((evt.touches[0].pageY-offsetTop)/mscale);
        writecxymessage(canvas, x, y);
    }, false);




}



</script></head><body onload="onloadf();">
    <!-- page content -->

<div id="canvasesdiv" style="position:relative; width:640px; height:480px">
<canvas id="maskcanvas"
style="z-index: 1;
position:absolute;
left:0px;
top:0px;
" height="480px" width="640">
This text is displayed if your browser does not support HTML5 Canvas.
</canvas>
<canvas id="maincanvas"
style="z-index: 2;
position:absolute;
left:0px;
top:0px;
" height="480px" width="640">
This text is displayed if your browser does not support HTML5 Canvas.
</canvas>
</div>


</body></html>
